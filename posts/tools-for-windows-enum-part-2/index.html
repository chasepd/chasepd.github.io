<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Enumerating Windows Machines For Fun And Legal Profit Part 2</title>
<meta name=description content="Overview of more advanced enumeration tools for use against Windows targets
             "><link rel=stylesheet href=/style.css><style>.navbar-container{display:flex;flex-direction:column;align-items:center;margin-bottom:2rem}.logo-full{display:block;margin:2rem auto .5rem;max-width:720px;height:256px;object-fit:contain}nav.navbar{display:flex;justify-content:center;align-items:center;gap:2.5rem;margin-bottom:1.5rem}.navbar-link{color:#eaeaea;font-size:1.1rem;text-decoration:none;font-weight:500;display:flex;align-items:center;transition:color .2s}.navbar-link:hover{color:#6ec1e4}.navbar-logo-text{height:2.2rem;width:auto;display:block}@media(max-width:600px){.logo-full{max-width:120px;height:40px}nav.navbar{gap:1.2rem}.navbar-logo-text{height:1.3rem}}</style></head><body><div class=navbar-container><a href=/><img src=/logofull.png alt="gentlem00se full logo" class=logo-full></a><nav class=navbar><a href=/ class=navbar-link>Home</a>
<a href=/categories/ class=navbar-link>Categories</a>
<a href=/about/ class=navbar-link>About</a></nav></div><div class=center-container><article class=post-article><h1>Enumerating Windows Machines For Fun And Legal Profit Part 2</h1><div class=post-date>Jul 2, 2025</div><nav class=post-toc><nav id=TableOfContents><ul><li><a href=#impacket-deep-protocol-interaction>Impacket: Deep Protocol Interaction</a></li><li><a href=#bloodhound-mapping-the-active-directory-landscape>BloodHound: Mapping the Active Directory Landscape</a></li><li><a href=#ldapdomaindump-comprehensive-ldap-enumeration>ldapdomaindump: Comprehensive LDAP Enumeration</a></li><li><a href=#putting-it-all-together-a-systematic-approach>Putting It All Together: A Systematic Approach</a></li><li><a href=#conclusion-building-your-windows-enumeration-expertise>Conclusion: Building Your Windows Enumeration Expertise</a></li></ul></nav></nav><div class=post-content><p>Whether you&rsquo;re conducting penetration testing or participating in Capture The Flag (CTF) competitions, one of the most critical phases is enumeration.</p><p>This is part two of a two part series on Windows enumeration. For the first part, see <a href=https://chasepd.github.io/posts/tools-for-windows-enum/>https://chasepd.github.io/posts/tools-for-windows-enum/</a>.</p><h2 id=impacket-deep-protocol-interaction>Impacket: Deep Protocol Interaction</h2><p>While NetExec provides broad coverage, Impacket offers deep, protocol-specific interaction capabilities. Think of Impacket as a specialized toolkit where each tool is designed for precise, targeted enumeration of specific Windows services and protocols.</p><p>Impacket&rsquo;s strength lies in its pure Python implementation of Windows protocols, which means it can interact with Windows services at a low level without requiring Windows-specific libraries or environments. I.e. you can run them from Kali Linux or whatever else you prefer instead of having to test from Windows.</p><p>There are three ways to get Impacket, and the way you get it onto your machine can change the command name slightly. It&rsquo;s also important to note that Impacket itself is actually just a python library, but the authors also wrote a number of example tools using it. To install, you can:</p><ol><li><em><strong>Install from your distro&rsquo;s package manager (if applicable)</strong></em></li></ol><ul><li><p>Many distros actually include some portion of the Impacket tool library in their official package repos, but how much of it is available can vary widely. It&rsquo;s pretty thorough in pentesting distros like Kali, but things like Ubuntu install a much more limited toolset. The package is called different things in different distros, so you will likely need to just search for Impacket in your package manager.</p></li><li><p>In this method, all of your tools will be run with <code>impacket-[toolname]</code> instead of the <code>.py</code> names for the other two methods.</p></li></ul><ol start=2><li><em><strong>Create a Python virtual environment and install via pip</strong></em><ul><li>Install with <code>pip install impacket</code>. This will install a consistent toolset no matter the environment but will only be available when that virtual environment is active unless you change your path to include it.</li></ul></li><li><em><strong>Clone the repo directly</strong></em><ul><li>You can also clone the source directly from the <a href=https://github.com/fortra/impacket>official repo</a>, and install it however the junk you want. The example scripts are in <code>/examples</code>. The biggest benefit of this method is you get exactly the version you want, and you get all the pre-built tools, not just what a package manager decided you probably wanted.</li></ul></li></ol><p>A significant number of Impacket&rsquo;s scripts need credentials to really function, so they are often a better tool for privilege escalation enumeration than just blind enumeration for a machine you have no access to.</p><p>Here&rsquo;s an example of <code>GetADUsers.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Enumerate all domain users with detailed attributes</span>
</span></span><span style=display:flex><span>GetADUsers.py -all domain.local/username:password -dc-ip 192.168.1.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This reveals not just usernames, but also:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Account creation dates</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Last logon times</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Password policy information</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Account status (enabled/disabled)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Group memberships</span>
</span></span></code></pre></div><p>Similarly, <code>GetNPUsers.py</code> targets a specific vulnerability pattern—accounts that don&rsquo;t require Kerberos pre-authentication. This tool demonstrates how Impacket combines enumeration with vulnerability identification:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Identify accounts vulnerable to ASREPRoasting</span>
</span></span><span style=display:flex><span>GetNPUsers.py domain.local/ -usersfile users.txt -format hashcat -outputfile hashes.txt
</span></span></code></pre></div><p>The secretsdump.py tool represents the ultimate goal of many enumeration exercises—extracting credential material from compromised systems:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Extract password hashes and other secrets</span>
</span></span><span style=display:flex><span>secretsdump.py domain.local/username:password@192.168.1.100
</span></span></code></pre></div><p>What often sets Impacket apart is its reliability. Because it implements Windows protocols from scratch, it often works in situations where other tools might fail due to compatibility issues or protocol variations.</p><h2 id=bloodhound-mapping-the-active-directory-landscape>BloodHound: Mapping the Active Directory Landscape</h2><p>BloodHound represents a paradigm shift in Active Directory enumeration. Rather than focusing on individual hosts or services, BloodHound creates a comprehensive map of relationships within the Active Directory environment. Think of it as creating a detailed organizational chart that shows not just who reports to whom, but also who has access to what, and how those access patterns create pathways through the network.</p><p>The thing I didn&rsquo;t understand when I first tried to use Bloodhound is that Bloodhound itself is just a relationship visualizer. The tool itself actually never connects to other hosts. Instead, it ingests data from other tools that output compatible data. Some of these include <code>SharpHound.exe</code> for running on a domain joined Windows machine, or <code>bloodhound-python</code> for running remotely from Linux.</p><p>The power of BloodHound lies in its graph-based approach to understanding Active Directory relationships. It collects data about users, groups, computers, and their interconnections, then presents this information in a visual format that makes complex attack paths immediately apparent.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Collect comprehensive AD data using SharpHound</span>
</span></span><span style=display:flex><span><span style=color:#75715e># From a Windows system with domain access:</span>
</span></span><span style=display:flex><span>SharpHound.exe -c All -d domain.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># From a Linux system using BloodHound.py:</span>
</span></span><span style=display:flex><span>bloodhound-python -u username -p password -ns 192.168.1.10 -d domain.local -c All
</span></span></code></pre></div><p>What makes BloodHound particularly valuable is its ability to identify attack paths that might not be obvious through traditional enumeration. For example, it might reveal that a service account you&rsquo;ve compromised has administrative rights on a server that contains sensitive data, or that a particular user group has privileges that could be chained together to achieve domain administrator access. Often, the default queries can be used to map a path for how you can go from a user you own to a domain administrator via abusing different permissions.</p><p>These queries built into BloodHound help focus your enumeration efforts on the most promising targets. Rather than manually analyzing hundreds of users and computers, you can quickly identify which accounts have the most privileges, which computers are most accessible, or which paths lead to high-value targets like domain controllers.</p><p>BloodHound also excels at persistence analysis—showing how an attacker might maintain access to the environment through multiple pathways. This perspective is crucial for both offensive and defensive security, as it reveals the true scope of potential compromise beyond the initial entry point.</p><h2 id=ldapdomaindump-comprehensive-ldap-enumeration>ldapdomaindump: Comprehensive LDAP Enumeration</h2><p>I think of <code>ldapdomaindump</code> as the &ldquo;poor man&rsquo;s Bloodhound&rdquo;. It definitely has its place in a pentesting toolkit, however, and I still use it, simply because sometimes the HTML outputs it produces are a helpful visualization, and don&rsquo;t rely on searching the way that Bloodhound&rsquo;s interface does. LDAP serves as the backbone of Active Directory, containing detailed information about every object in the domain. Think of ldapdomaindump as a detailed census taker that methodically catalogs every person, place, and thing in the digital domain.</p><p>What sets ldapdomaindump apart is its thoroughness and its presentation format. Rather than simply dumping raw LDAP data, it processes and organizes the information into human-readable HTML reports that make analysis much more manageable. This dump is best combined with Bloodhound for deeper investigation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Perform comprehensive LDAP enumeration</span>
</span></span><span style=display:flex><span>ldapdomaindump -u <span style=color:#e6db74>&#39;domain.local\username&#39;</span> -p <span style=color:#e6db74>&#39;password&#39;</span> 192.168.1.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This creates several HTML files:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - domain_computers.html: All computer accounts with details</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - domain_users.html: All user accounts with attributes</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - domain_groups.html: All groups and memberships</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - domain_policy.html: Domain and password policies</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - domain_trusts.html: Trust relationships with other domains</span>
</span></span></code></pre></div><h2 id=putting-it-all-together-a-systematic-approach>Putting It All Together: A Systematic Approach</h2><p>Effective Windows enumeration requires a systematic approach that builds understanding progressively. Think of it as constructing a detailed map of enemy territory—you start with broad reconnaissance and gradually fill in the details as you gather more information.</p><p>The typical enumeration workflow begins with network discovery to identify active hosts and services. nmap, like on linux, serves as your primary tool for this phase, quickly identifying systems running Windows services and providing basic system information. netexec can help you dive in further on those while enum4linux finds interesting places to investigate further. This initial reconnaissance establishes the scope of your target environment and identifies the most promising systems for further investigation. File share enumeration with smbmap and smbclient can help find initial information available, and can be a good place to come back to once you get credentials to the machine.</p><p>Once you have credentials or have discovered the machine allows anonymous access, you should begin mapping the Active Directory structure using BloodHound and ldapdomaindump. This tool provides the strategic overview that helps you understand how individual systems and accounts fit into the larger organizational structure. BloodHound&rsquo;s analysis capabilities help you identify high-value targets and potential attack paths that might not be apparent from individual system enumeration. Impacket&rsquo;s specialized tools also come into play here, allowing you to interact with specific Windows services to extract detailed information about users, groups, and system configurations, potentially finding new vulnerabilities to exploit to help you pivot through the Active Directory graph.</p><p>Credential management becomes increasingly complex as exploitation progresses. You&rsquo;ll often discover multiple sets of credentials with different privilege levels and access patterns. Maintaining clear records of which credentials work where, and what level of access they provide, prevents confusion and ensures you can leverage each discovered credential effectively.</p><h2 id=conclusion-building-your-windows-enumeration-expertise>Conclusion: Building Your Windows Enumeration Expertise</h2><p>Mastering Windows enumeration requires understanding both the technical capabilities of individual tools and the strategic thinking needed to combine them effectively. Each tool we&rsquo;ve explored serves a specific purpose in the larger enumeration ecosystem, and their true power emerges when they&rsquo;re used together systematically.</p><p>The tools and techniques covered in this guide provide a solid foundation for Windows enumeration, but remember that the landscape continues to evolve. New tools emerge, existing tools receive updates, and defensive technologies adapt to counter enumeration techniques. Staying current with these developments and practicing in controlled environments like personal labs and CTF competitions ensures your skills remain sharp and relevant.</p><p>Most importantly, remember that enumeration is not just about running tools—it&rsquo;s about understanding the story they tell about your target environment. The most successful penetration testers and CTF participants are those who can synthesize information from multiple sources, identify patterns and relationships, and translate technical findings into actionable intelligence for achieving their objectives.</p></div></article></div><script src=/lightbox.js></script></body></html>
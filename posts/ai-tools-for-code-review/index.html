<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Leveraging AI Coding Tools for Security Code Review and Whitebox Penetration Testing</title>
<meta name=description content="A practical guide to using AI tools like Cursor for enhanced security code review and whitebox penetration testing workflows
             "><link rel=stylesheet href=/style.css><style>.navbar-container{display:flex;flex-direction:column;align-items:center;margin-bottom:2rem}.logo-full{display:block;margin:2rem auto .5rem;max-width:720px;height:256px;object-fit:contain}nav.navbar{display:flex;justify-content:center;align-items:center;gap:2.5rem;margin-bottom:1.5rem}.navbar-link{color:#eaeaea;font-size:1.1rem;text-decoration:none;font-weight:500;display:flex;align-items:center;transition:color .2s}.navbar-link:hover{color:#6ec1e4}.navbar-logo-text{height:2.2rem;width:auto;display:block}@media(max-width:600px){.logo-full{max-width:120px;height:40px}nav.navbar{gap:1.2rem}.navbar-logo-text{height:1.3rem}}</style></head><body><div class=navbar-container><a href=/><img src=/logofull.png alt="gentlem00se full logo" class=logo-full></a><nav class=navbar><a href=/ class=navbar-link>Home</a>
<a href=/categories/ class=navbar-link>Categories</a>
<a href=/about/ class=navbar-link>About</a></nav></div><div class=center-container><article class=post-article><h1>Leveraging AI Coding Tools for Security Code Review and Whitebox Penetration Testing</h1><div class=post-date>Jul 11, 2025</div><nav class=post-toc><nav id=TableOfContents><ul><li><a href=#the-security-engineers-dilemma>The Security Engineer&rsquo;s Dilemma</a></li><li><a href=#limitations-and-considerations>Limitations and Considerations</a><ul><li><a href=#what-ai-gets-wrong>What AI Gets Wrong</a></li></ul></li><li><a href=#asking-the-right-questions>Asking The Right Questions</a><ul><li><a href=#secure-code-review>Secure Code Review</a></li><li><a href=#penetration-testing>Penetration Testing</a></li><li><a href=#real-example>Real Example</a></li></ul></li><li><a href=#next-steps>Next Steps</a></li></ul></nav></nav><div class=post-content><h1 id=introduction>Introduction</h1><p>AI coding tools have fundamentally changed how developers write code, but their impact on security engineering workflows is still being explored. As someone who spends significant time reviewing code for vulnerabilities and conducting whitebox penetration tests, I&rsquo;ve found that tools like Cursor can significantly enhance both the speed and thoroughness of security assessments.</p><p>This post covers practical strategies for integrating AI coding assistants into security code review and whitebox penetration testing workflows, based on real-world experience using these tools in production environments.</p><h2 id=the-security-engineers-dilemma>The Security Engineer&rsquo;s Dilemma</h2><p>Application and product security engineers face a number of challenges:</p><ul><li><strong>Scale</strong>: Modern applications contain millions of lines of code across multiple repositories</li><li><strong>Context switching</strong>: Security engineers often support numerous codebases, and are frequently switching between them</li><li><strong>Business logic errors</strong>: Identifying business logic errors across large codebases, which scanning tools like SAST would never find</li><li><strong>Time constraints</strong>: Balancing thorough review and testing with other projects</li></ul><p>AI coding tools can help serve as an &ldquo;extra brain&rdquo; for a security engineer, and can assist with these challenges.</p><h2 id=limitations-and-considerations>Limitations and Considerations</h2><h3 id=what-ai-gets-wrong>What AI Gets Wrong</h3><p>Before we dive deeper, I want to note that there are limitations here:</p><ul><li><strong>Models may hallucinate</strong>: Ever spent an hour diving deep into the deep magic of Salesforce&rsquo;s proprietary language Apex because ChatGPT and Cursor both hallucinated the same incorrect syntax? Fun story&mldr;</li><li><strong>Context blindness</strong>: Can miss business logic flaws that require knowledge outside the codebase (although you can mitigate this by cloning a particularly important repo or two and moving the directory temporarily inside the codebase you&rsquo;re working on)</li><li><strong>Bias toward common patterns</strong>: May miss novel or sophisticated attack vectors, given that LLMs work by statistical prediction based on what they&rsquo;ve seen before</li><li><strong>Not a substitute for real security review</strong>: Assistants are best used as a reference or a more advanced search engine for the code, rather than an automated replacement for actual security review or testing. Trust me, I&rsquo;ve tried it for science. They suck at it.</li></ul><h2 id=asking-the-right-questions>Asking The Right Questions</h2><p>The key to effective AI usage is asking the right questions, and using the right prompts. As tempting as it is to just enter <code>pls gib sekurities</code> and hope the AI gets it right while you play video games all day, surprise, surprise, that ain&rsquo;t gonna cut it.</p><h3 id=secure-code-review>Secure Code Review</h3><p>When using an AI to assist with code review, the key is to ask it to review <em>specific things</em>, rather than the entire codebase. Instead of &ldquo;<em>Are there any security vulnerabilities in this codebase?</em>&rdquo;, think about what attack vectors the codebase has. Better yet, look back at your threat model for the specific vectors you identified there. Then ask the assistant to review that functionality specifically.</p><p>Examples:</p><blockquote><p>Where is the authorization logic implemented in this codebase? Find it, and assess it for potential authorization flaws or oversights that might result in authorization working differently than intended.</p></blockquote><blockquote><p>This codebase interacts with a SQL database. Please locate where queries are executed and evaluate whether parameterization is used correctly.</p></blockquote><blockquote><p>Determine whether this JWT validation logic correctly performs expiration checks, signature validation, and checking of the issuer.</p></blockquote><blockquote><p>I&rsquo;m most fluent in Python - can you give me the Python equivalent of this Javascript function, and explain what Javascript nuances might not translate well to Python?</p></blockquote><h3 id=penetration-testing>Penetration Testing</h3><p>Using an AI assistant with whitebox penetration testing is very similar. The key is to use it to analyze things you&rsquo;ve already found. Rather than asking &ldquo;How do I exploit this codebase?&rdquo;, ask it about specific components. Especially when doing this on an unfamiliar codebase, it can help you find specific logic that you can analyze for vulnerabilities. It can also validate your assumptions about how a certain thing works, although double-checking or asking for sources on specific functionality of a library is a good idea (see above reference to a sidetrip into Apex land).</p><p>Some examples of good prompting for assisting with penetration tests:</p><blockquote><p>The /users endpoint in this code appears to error out whenever I include a single-quote character in the username. Find the code that would throw this error, and determine whether this might indicate a lack of proper sanitization.</p></blockquote><blockquote><p>I&rsquo;ve identified a SQL injection vulnerability in this SQL statement, in the username parameter that is string-appended to the query here. Please give some examples of potential blind SQL injection payloads that would exploit that vulnerability to get information about user passwords.</p></blockquote><p>Additionally, coding assistants can make building custom exploits trivial. Sure, you probably could code a custom python script to exploit that XSS vulnerability you found all on your own, but can you do it in 5 minutes? Will the exploit script have a nice user interface with error handling and ASCII art kittens?</p><h3 id=real-example>Real Example</h3><p>Let&rsquo;s analyze ye olde <a href=https://github.com/juice-shop/juice-shop>OWASP Juice Shoppe</a> with AI assistant help. For this demo I&rsquo;m going to use Cursor (at the time of writing Cursor is my preferred coding assistant, <a href=https://techcrunch.com/2025/07/07/cursor-apologizes-for-unclear-pricing-changes-that-upset-users/>pricing shenanigans</a> notwithstanding).</p><p>If you&rsquo;d like to follow along at home and want to actually try the exploits your AI assistant surfaces, you can get a short-lived juice shop instance running quickly with <code>docker run --rm -p 3000:3000 -d bkimminich/juice-shop</code>. Don&rsquo;t forget to clone the codebase also, as using the AI assistant codebase analysis is like, the entire point of this exercise. So you&rsquo;ll probably need the actual codebase.</p><p>Let&rsquo;s start with a braindead query and see how it does. After all:</p><figure style=display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%><img src=/posts/ai-tools-for-code-review/taking-shots.png alt="Missing 100%" loading=lazy style="max-width:100%;height:auto;display:block;margin:0 auto"></figure><p>The query:</p><figure style=display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%><img src=/posts/ai-tools-for-code-review/braindead-query.png alt="find security vulnerabilities" loading=lazy style="max-width:100%;height:auto;display:block;margin:0 auto"></figure><p>It&rsquo;s like even the model realizes we&rsquo;re phoning it in. In true apathetic fashion, let&rsquo;s give it as little guidance as possible (putting this response in quote form rather than a screenshot due to length):</p><blockquote><p>Chase: manual<br>Cursor:
Great! For a manual security review, Iâ€™ll look for common vulnerability patterns in >your codebase, such as:<br>Hardcoded secrets/credentials</p><ul><li>SQL injection</li><li>Cross-Site Scripting (XSS)</li><li>Cross-Site Request Forgery (CSRF)</li><li>Insecure file uploads</li><li>Insecure authentication/authorization</li><li>Use of unsafe APIs or functions</li><li>Insecure deserialization</li><li>Directory traversal</li><li>Information disclosure</li></ul><p>Given the size of your project, Iâ€™ll start by searching for high-risk patterns and files that are most likely to contain vulnerabilities (e.g., routes, models, services, and config files).</p><p>Iâ€™ll begin with:</p><ul><li>Hardcoded secrets/credentials</li><li>Dangerous function usage (e.g., eval, exec, child_process, etc.)</li><li>SQL/NoSQL injection patterns</li><li>XSS in templates and API responses</li><li>Insecure file upload handling</li></ul><p>Letâ€™s start with the first two. Iâ€™ll search for hardcoded secrets and dangerous function usage.<br>Here are the initial findings from the manual review for security vulnerabilities:</p><ol><li>Hardcoded Secrets/Credentials<br>Most matches are in test files (e.g., token12345, passwords, JWTs, etc.), which is expected and not a direct risk for production.<br>No obvious hardcoded secrets or credentials found in main application code from the initial search. However, further review of config files and environment variable usage is recommended for a thorough check.</li><li>Dangerous Function Usage (Potential Code Injection/RCE)</li></ol><pre tabindex=0><code>eval usage:  
routes/captcha.ts: const answer = eval(expression).toString()  
routes/userProfile.ts: username = eval(code)  
routes/b2bOrder.ts: vm.runInContext(&#39;safeEval(orderLinesData)&#39;, sandbox, { timeout: 2000 })  
test/cypress/e2e/contact.spec.ts: const answer = eval(val).toString()  
test/cypress/e2e/basket.spec.ts: win.eval(...)  
child_process.exec usage:  
test/cypress/e2e/profile.spec.ts: Executes a shell command via child_process.exec (in a test context).  
setTimeout/setInterval/Function usage: Found in various places, but these are not inherently dangerous unless user input is passed to them. 
</code></pre><p>The most critical are the eval and vm.runInContext usages in the main application code (not tests), as these can lead to Remote Code Execution (RCE) if user input is not properly sanitized.<br><strong>Next Steps:</strong></p><ul><li>Review the context and input validation for each <code>eval</code>/<code>vm.runInContext</code> usage in the main app code.</li><li>Check for SQL/NoSQL injection patterns in route handlers and database queries.</li><li>Look for XSS vulnerabilities in template rendering and API responses.</li><li>Review file upload handling for security issues.</li></ul><p><strong>Would you like me to:</strong></p><ul><li>Dive deeper into the <code>eval</code>/<code>vm.runInContext</code> usages to assess exploitability?</li><li>Move on to SQL/NoSQL injection and XSS checks?</li><li>Or focus on another area first?</li></ul></blockquote><p>Ok, that was actually pretty good for a first swing. Granted, this codebase is an explosion of vulnerabilites, but still, nice job, Cursor.</p><p>Let&rsquo;s try something more targeted (in a new chat, of course, so the new model doesn&rsquo;t know what a slacker I was being before). It should be noted that since the README.md file has notes all over about how this is a CTF and is intentionally insecure, I had to have it review very specific files to get realistic results. You wouldn&rsquo;t need to do that in a real codebase.</p><figure style=display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%><img src=/posts/ai-tools-for-code-review/passreset.png alt="password reset eval" loading=lazy style="max-width:100%;height:auto;display:block;margin:0 auto"></figure><p>Pretty solid. It gave us an explanation of how the functionality works, and also where the vulnerability is.</p><p>We could keep going with this, but rather than reading through me doing this, you should try it yourself.</p><h2 id=next-steps>Next Steps</h2><p>If you&rsquo;re interested in including AI assistants in your application security workflows:</p><ol><li>Try it out on an intentionally vulnerable codebase (like Juice Shop)</li><li>Try assessing some of your actual codebases with an AI Assistant (if allowed by your company&rsquo;s policies)</li><li>Hack the World (as long as you get permission)</li></ol><p>The goal isn&rsquo;t to replace security engineering expertise, but to augment it with tools that can help us keep pace with the scale and complexity of modern applications.</p></div></article></div><script src=/lightbox.js></script></body></html>